
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pyemu package &#8212; pyEMU 0.3 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pyemu-package">
<h1>pyemu package<a class="headerlink" href="#pyemu-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyemu.mat.html">pyemu.mat package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyemu.mat.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.mat.html#module-pyemu.mat.mat_handler">pyemu.mat.mat_handler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.mat.html#module-pyemu.mat">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyemu.pst.html">pyemu.pst package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyemu.pst.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.pst.html#module-pyemu.pst.pst_controldata">pyemu.pst.pst_controldata module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.pst.html#module-pyemu.pst.pst_handler">pyemu.pst.pst_handler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.pst.html#module-pyemu.pst.pst_utils">pyemu.pst.pst_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.pst.html#module-pyemu.pst">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyemu.utils.html">pyemu.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.geostats">pyemu.utils.geostats module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.gw_utils">pyemu.utils.gw_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.helpers">pyemu.utils.helpers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.optimization">pyemu.utils.optimization module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.pp_utils">pyemu.utils.pp_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyemu.en">
<span id="pyemu-en-module"></span><h2>pyemu.en module<a class="headerlink" href="#module-pyemu.en" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyemu.en.Ensemble">
<em class="property">class </em><code class="descclassname">pyemu.en.</code><code class="descname">Ensemble</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#Ensemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.Ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">pandas.core.frame.DataFrame</span></code></p>
<dl class="docutils">
<dt>The base class type for handling parameter and observation ensembles.</dt>
<dd>It is directly derived from pandas.DataFrame.  This class should not be
instantiated directly.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>*args</strong> (<em>list</em>) – positional args to pass to pandas.DataFrame()</li>
<li><strong>**kwargs</strong> (<em>dict</em>) – keyword args to pass to pandas.DataFrame().  Must contain
‘columns’ and ‘mean_values’</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Ensemble</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble">Ensemble</a></p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pyemu.en.Ensemble.as_pyemu_matrix">
<code class="descname">as_pyemu_matrix</code><span class="sig-paren">(</span><em>typ=&lt;class 'pyemu.mat.mat_handler.Matrix'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#Ensemble.as_pyemu_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.Ensemble.as_pyemu_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pyemu.Matrix from the Ensemble.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>typ</strong> (<em>pyemu.Matrix</em><em> or </em><em>derived type</em>) – the type of matrix to return</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>pyemu.Matrix</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.Ensemble.drop">
<code class="descname">drop</code><span class="sig-paren">(</span><em>arg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#Ensemble.drop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.Ensemble.drop" title="Permalink to this definition">¶</a></dt>
<dd><p>overload of pandas.DataFrame.drop()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arg</strong> (<em>iterable</em>) – argument to pass to pandas.DataFrame.drop()</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>Ensemble</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble">Ensemble</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.Ensemble.dropna">
<code class="descname">dropna</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#Ensemble.dropna"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.Ensemble.dropna" title="Permalink to this definition">¶</a></dt>
<dd><p>overload of pandas.DataFrame.dropna()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>*args</strong> (<em>list</em>) – positional args to pass to pandas.DataFrame.dropna()</li>
<li><strong>**kwargs</strong> (<em>dict</em>) – keyword args to pass to pandas.DataFrame.dropna()</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Ensemble</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble">Ensemble</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.Ensemble.draw">
<code class="descname">draw</code><span class="sig-paren">(</span><em>cov</em>, <em>num_reals=1</em>, <em>names=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#Ensemble.draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.Ensemble.draw" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>draw random realizations from a multivariate</dt>
<dd>Gaussian distribution</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cov</strong> (<em>pyemu.Cov</em>) – covariance structure to draw from</li>
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to generate</li>
<li><strong>names</strong> (<em>list</em>) – list of columns names to draw for.  If None, values all names
are drawn</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.Ensemble.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>bins=10</em>, <em>facecolor='0.5'</em>, <em>plot_cols=None</em>, <em>filename='ensemble.pdf'</em>, <em>func_dict=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#Ensemble.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.Ensemble.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>plot ensemble histograms to multipage pdf</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bins</strong> (<em>int</em>) – number of bins</li>
<li><strong>facecolor</strong> (<em>str</em>) – color</li>
<li><strong>plot_cols</strong> (<em>list of str</em>) – subset of ensemble columns to plot.  If None, all are plotted.
Default is None</li>
<li><strong>filename</strong> (<em>str</em>) – pdf filename. Default is “ensemble.pdf”</li>
<li><strong>func_dict</strong> (<em>dict</em>) – a dict of functions to apply to specific columns (e.g., np.log10)</li>
<li><strong>**kwargs</strong> (<em>dict</em>) – keyword args to pass to plot_utils.ensemble_helper()</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pyemu.en.Ensemble.from_dataframe">
<em class="property">classmethod </em><code class="descname">from_dataframe</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#Ensemble.from_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.Ensemble.from_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>class method constructor to create an Ensemble from
a pandas.DataFrame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> (<em>dict</em>) – optional args to pass to the
Ensemble Constructor.  Expects ‘df’ in kwargs.keys()
that must be a pandas.DataFrame instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>Ensemble</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble">Ensemble</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="pyemu.en.Ensemble.reseed">
<em class="property">static </em><code class="descname">reseed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#Ensemble.reseed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.Ensemble.reseed" title="Permalink to this definition">¶</a></dt>
<dd><p>method to reset the numpy.random seed using the pyemu.en
SEED global variable</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.Ensemble.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#Ensemble.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.Ensemble.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>make a deep copy of self</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>Ensemble</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble">Ensemble</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.Ensemble.covariance_matrix">
<code class="descname">covariance_matrix</code><span class="sig-paren">(</span><em>localizer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#Ensemble.covariance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.Ensemble.covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate the approximate covariance matrix implied by the ensemble using
mean-differencing operation at the core of EnKF</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>localizer</strong> (<em>pyemu.Matrix</em>) – covariance localizer to apply</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>cov</strong> – covariance matrix</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Cov</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyemu.en.ObservationEnsemble">
<em class="property">class </em><code class="descclassname">pyemu.en.</code><code class="descname">ObservationEnsemble</code><span class="sig-paren">(</span><em>pst</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ObservationEnsemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ObservationEnsemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble"><code class="xref py py-class docutils literal"><span class="pre">pyemu.en.Ensemble</span></code></a></p>
<p>Ensemble derived type for observations.  This class is primarily used to
generate realizations of observation noise.  These are typically generated from
the weights listed in the control file.  However, a general covariance matrix can
be explicitly used.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Does not generate noise realizations for observations with zero weight</p>
</div>
<dl class="method">
<dt id="pyemu.en.ObservationEnsemble.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ObservationEnsemble.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ObservationEnsemble.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>overload of Ensemble.copy()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ObservationEnsemble</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyemu.en.ObservationEnsemble" title="pyemu.en.ObservationEnsemble">ObservationEnsemble</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ObservationEnsemble.names">
<code class="descname">names</code><a class="headerlink" href="#pyemu.en.ObservationEnsemble.names" title="Permalink to this definition">¶</a></dt>
<dd><p>property decorated method to get current non-zero weighted
column names.  Uses ObservationEnsemble.pst.nnz_obs_names</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>list</strong> – non-zero weight observation names</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ObservationEnsemble.mean_values">
<code class="descname">mean_values</code><a class="headerlink" href="#pyemu.en.ObservationEnsemble.mean_values" title="Permalink to this definition">¶</a></dt>
<dd><p>property decorated method to get mean values of observation noise.
This is a zero-valued pandas.Series</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>mean_values</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas Series</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ObservationEnsemble.draw">
<code class="descname">draw</code><span class="sig-paren">(</span><em>cov</em>, <em>num_reals</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ObservationEnsemble.draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ObservationEnsemble.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>draw realizations of observation noise and add to mean_values
Note: only draws noise realizations for non-zero weighted observations
zero-weighted observations are set to mean value for all realizations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cov</strong> (<em>pyemu.Cov</em>) – covariance matrix that describes the support volume around the
mean values.</li>
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to draw</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ObservationEnsemble.nonzero">
<code class="descname">nonzero</code><a class="headerlink" href="#pyemu.en.ObservationEnsemble.nonzero" title="Permalink to this definition">¶</a></dt>
<dd><p>property decorated method to get a new ObservationEnsemble
of only non-zero weighted observations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ObservationEnsemble</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyemu.en.ObservationEnsemble" title="pyemu.en.ObservationEnsemble">ObservationEnsemble</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pyemu.en.ObservationEnsemble.from_id_gaussian_draw">
<em class="property">classmethod </em><code class="descname">from_id_gaussian_draw</code><span class="sig-paren">(</span><em>pst</em>, <em>num_reals</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ObservationEnsemble.from_id_gaussian_draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ObservationEnsemble.from_id_gaussian_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>this is an experiemental method to help speed up independent draws
for a really large (&gt;1E6) ensemble sizes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – a control file instance</li>
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to draw</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ObservationEnsemble</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.ObservationEnsemble" title="pyemu.en.ObservationEnsemble">ObservationEnsemble</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ObservationEnsemble.to_binary">
<code class="descname">to_binary</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ObservationEnsemble.to_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ObservationEnsemble.to_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>write the observation ensemble to a jco-style binary file.  The
ensemble is transposed in the binary file so that the 20-char obs
names are carried</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) – the filename to write</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The ensemble is transposed in the binary file</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="pyemu.en.ObservationEnsemble.from_binary">
<em class="property">classmethod </em><code class="descname">from_binary</code><span class="sig-paren">(</span><em>pst</em>, <em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ObservationEnsemble.from_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ObservationEnsemble.from_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiate an observation obsemble from a jco-type file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – a Pst instance</li>
<li><strong>filename</strong> (<em>str</em>) – the binary file name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>oe</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.ObservationEnsemble" title="pyemu.en.ObservationEnsemble">ObservationEnsemble</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ObservationEnsemble.phi_vector">
<code class="descname">phi_vector</code><a class="headerlink" href="#pyemu.en.ObservationEnsemble.phi_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>property decorated method to get a vector of L2 norm (phi)
for the realizations.  The ObservationEnsemble.pst.weights can be
updated prior to calling this method to evaluate new weighting strategies</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>pandas.DataFrame</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ObservationEnsemble.add_base">
<code class="descname">add_base</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ObservationEnsemble.add_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ObservationEnsemble.add_base" title="Permalink to this definition">¶</a></dt>
<dd><p>add “base” control file values as a realization</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyemu.en.ParameterEnsemble">
<em class="property">class </em><code class="descclassname">pyemu.en.</code><code class="descname">ParameterEnsemble</code><span class="sig-paren">(</span><em>pst</em>, <em>istransformed=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble"><code class="xref py py-class docutils literal"><span class="pre">pyemu.en.Ensemble</span></code></a></p>
<dl class="docutils">
<dt>Ensemble derived type for parameters</dt>
<dd>implements bounds enforcement, log10 transformation,
fixed parameters and null-space projection
Note: uses the parnme attribute of Pst.parameter_data from column names
and uses the parval1 attribute of Pst.parameter_data as mean values</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – The ‘columns’ and ‘mean_values’ args need for Ensemble
are derived from the pst.parameter_data.parnme and pst.parameter_data.parval1
items, respectively</li>
<li><strong>istransformed</strong> (<em>bool</em>) – flag indicating the transformation status (log10) of the arguments be passed</li>
<li><strong>**kwargs</strong> (<em>dict</em>) – keyword arguments to pass to Ensemble constructor.</li>
<li><strong>bound_tol</strong> (<em>float</em>) – fractional amount to reset bounds transgression within the bound.
This has been shown to be very useful for the subsequent recalibration
because it moves parameters off of their bounds, so they are not treated as frozen in
the upgrade calculations. defaults to 0.0</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ParameterEnsemble</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.ParameterEnsemble" title="pyemu.en.ParameterEnsemble">ParameterEnsemble</a></p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.dropna">
<code class="descname">dropna</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.dropna"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.dropna" title="Permalink to this definition">¶</a></dt>
<dd><p>overload of pandas.DataFrame.dropna()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>*args</strong> (<em>list</em>) – positional args to pass to pandas.DataFrame.dropna()</li>
<li><strong>**kwargs</strong> (<em>dict</em>) – keyword args to pass to pandas.DataFrame.dropna()</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Ensemble</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble">Ensemble</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>overload of Ensemble.copy()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ParameterEnsemble</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyemu.en.ParameterEnsemble" title="pyemu.en.ParameterEnsemble">ParameterEnsemble</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ParameterEnsemble.istransformed">
<code class="descname">istransformed</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.istransformed" title="Permalink to this definition">¶</a></dt>
<dd><p>property decorated method to get the current
transformation status of the ParameterEnsemble</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>istransformed</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ParameterEnsemble.mean_values">
<code class="descname">mean_values</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.mean_values" title="Permalink to this definition">¶</a></dt>
<dd><p>the mean value vector while respecting log transform</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>mean_values</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.Series</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ParameterEnsemble.names">
<code class="descname">names</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.names" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the names of the parameters in the ParameterEnsemble</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>list</strong> – parameter names</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ParameterEnsemble.adj_names">
<code class="descname">adj_names</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.adj_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the names of adjustable parameters in the ParameterEnsemble</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>list</strong> – adjustable parameter names</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ParameterEnsemble.ubnd">
<code class="descname">ubnd</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.ubnd" title="Permalink to this definition">¶</a></dt>
<dd><p>the upper bound vector while respecting log transform</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ubnd</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.Series</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ParameterEnsemble.lbnd">
<code class="descname">lbnd</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.lbnd" title="Permalink to this definition">¶</a></dt>
<dd><p>the lower bound vector while respecting log transform</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>lbnd</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.Series</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ParameterEnsemble.log_indexer">
<code class="descname">log_indexer</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.log_indexer" title="Permalink to this definition">¶</a></dt>
<dd><p>indexer for log transform</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>log_indexer</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.Series</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.en.ParameterEnsemble.fixed_indexer">
<code class="descname">fixed_indexer</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.fixed_indexer" title="Permalink to this definition">¶</a></dt>
<dd><p>indexer for fixed status</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>fixed_indexer</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.Series</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.draw">
<code class="descname">draw</code><span class="sig-paren">(</span><em>cov</em>, <em>num_reals=1</em>, <em>how='normal'</em>, <em>enforce_bounds=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>draw realizations of parameter values</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cov</strong> (<em>pyemu.Cov</em>) – covariance matrix that describes the support around
the mean parameter values</li>
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to generate</li>
<li><strong>how</strong> (<em>str</em>) – distribution to use to generate realizations.  Options are
‘normal’ or ‘uniform’.  Default is ‘normal’.  If ‘uniform’,
cov argument is ignored</li>
<li><strong>enforce_bounds</strong> (<em>str</em>) – how to enforce parameter bound violations.  Options are
‘reset’ (reset individual violating values), ‘drop’ (drop realizations
that have one or more violating values.  Default is None (no bounds enforcement)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pyemu.en.ParameterEnsemble.from_uniform_draw">
<em class="property">classmethod </em><code class="descname">from_uniform_draw</code><span class="sig-paren">(</span><em>pst</em>, <em>num_reals</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.from_uniform_draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_uniform_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiate a parameter ensemble from uniform draws</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – a control file instance</li>
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to generate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ParameterEnsemble</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.ParameterEnsemble" title="pyemu.en.ParameterEnsemble">ParameterEnsemble</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pyemu.en.ParameterEnsemble.from_triangular_draw">
<em class="property">classmethod </em><code class="descname">from_triangular_draw</code><span class="sig-paren">(</span><em>pst</em>, <em>num_reals</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.from_triangular_draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_triangular_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiate a parameter ensemble from triangular distribution</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – a control file instance</li>
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to generate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ParameterEnsemble</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.ParameterEnsemble" title="pyemu.en.ParameterEnsemble">ParameterEnsemble</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pyemu.en.ParameterEnsemble.from_sparse_gaussian_draw">
<em class="property">classmethod </em><code class="descname">from_sparse_gaussian_draw</code><span class="sig-paren">(</span><em>pst</em>, <em>cov</em>, <em>num_reals</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.from_sparse_gaussian_draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_sparse_gaussian_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiate a parameter ensemble from a sparse covariance matrix.
This is an advanced user method that assumes you know what you are doing
- few guard rails…</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – a control file instance</li>
<li><strong>cov</strong> (<em>(</em><em>pyemu.SparseMatrix</em><em>)</em>) – sparse covariance matrix to use for drawing</li>
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to generate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ParameterEnsemble</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.ParameterEnsemble" title="pyemu.en.ParameterEnsemble">ParameterEnsemble</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pyemu.en.ParameterEnsemble.from_gaussian_draw">
<em class="property">classmethod </em><code class="descname">from_gaussian_draw</code><span class="sig-paren">(</span><em>pst</em>, <em>cov</em>, <em>num_reals=1</em>, <em>use_homegrown=True</em>, <em>group_chunks=False</em>, <em>fill_fixed=True</em>, <em>enforce_bounds=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.from_gaussian_draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_gaussian_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiate a parameter ensemble from a covariance matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – a control file instance</li>
<li><strong>cov</strong> (<em>(</em><em>pyemu.Cov</em><em>)</em>) – covariance matrix to use for drawing</li>
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to generate</li>
<li><strong>use_homegrown</strong> (<em>bool</em>) – flag to use home-grown full cov draws…much faster
than numpy…</li>
<li><strong>group_chunks</strong> (<em>bool</em>) – flag to break up draws by par groups.  Only applies
to homegrown, full cov case. Default is False</li>
<li><strong>fill_fixed</strong> (<em>bool</em>) – flag to fill in fixed parameters from the pst into the
ensemble using the parval1 from the pst.  Default is True</li>
<li><strong>enforce_bounds</strong> (<em>bool</em>) – flag to enforce parameter bounds from the pst.  realized
parameter values that violate bounds are simply changed to the
value of the violated bound.  Default is False</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ParameterEnsemble</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.ParameterEnsemble" title="pyemu.en.ParameterEnsemble">ParameterEnsemble</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pyemu.en.ParameterEnsemble.from_mixed_draws">
<em class="property">classmethod </em><code class="descname">from_mixed_draws</code><span class="sig-paren">(</span><em>pst</em>, <em>how_dict</em>, <em>default='gaussian'</em>, <em>num_reals=100</em>, <em>cov=None</em>, <em>sigma_range=6</em>, <em>enforce_bounds=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.from_mixed_draws"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_mixed_draws" title="Permalink to this definition">¶</a></dt>
<dd><p>instaniate a parameter ensemble from stochastic draws using a mixture of
distributions.  Available distributions include (log) “uniform”, (log) “triangular”,
and (log) “gaussian”. log transformation is respected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – a Pst instance</li>
<li><strong>how_dict</strong> (<em>dict</em>) – a dictionary of parnme keys and ‘how’ values, where “how” can be “uniform”,
“triangular”, or “gaussian”.</li>
<li><strong>default</strong> (<em>str</em>) – the default distribution to use for parameter not listed in how_dict</li>
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to draw</li>
<li><strong>cov</strong> (<em>pyemu.Cov</em>) – an optional Cov instance to use for drawing from gaussian distribution.  If None,
and “gaussian” is listed in how_dict (or default), then a diagonal covariance matrix
is constructed from the parameter bounds in the pst.  Default is None</li>
<li><strong>sigma_range</strong> (<em>float</em>) – the number of standard deviations implied by the bounds in the pst.  Only used if
“gaussian” is in how_dict (or default) and cov is None.  Default is 6.</li>
<li><strong>enforce_bounds</strong> (<em>boolean</em>) – flag to enforce parameter bounds in resulting ParameterEnsemble.
Only matters if “gaussian” is in values of how_dict.  Default is True.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pyemu.en.ParameterEnsemble.from_binary">
<em class="property">classmethod </em><code class="descname">from_binary</code><span class="sig-paren">(</span><em>pst</em>, <em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.from_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiate an parameter obsemble from a jco-type file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – a Pst instance</li>
<li><strong>filename</strong> (<em>str</em>) – the binary file name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pe</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.ParameterEnsemble" title="pyemu.en.ParameterEnsemble">ParameterEnsemble</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.project">
<code class="descname">project</code><span class="sig-paren">(</span><em>projection_matrix</em>, <em>inplace=True</em>, <em>log=None</em>, <em>enforce_bounds='reset'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.project"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.project" title="Permalink to this definition">¶</a></dt>
<dd><p>project the ensemble using the null-space Monte Carlo method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>projection_matrix</strong> (<em>pyemu.Matrix</em>) – projection operator - must already respect log transform</li>
<li><strong>inplace</strong> (<em>bool</em>) – project self or return a new ParameterEnsemble instance</li>
<li><strong>log</strong> (<em>pyemu.Logger</em>) – for logging progress</li>
<li><strong>enforce_bounds</strong> (<em>str</em>) – parameter bound enforcement flag. ‘drop’ removes
offending realizations, ‘reset’ resets offending values</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ParameterEnsemble</strong> – if inplace is False</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.en.ParameterEnsemble" title="pyemu.en.ParameterEnsemble">ParameterEnsemble</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.enforce">
<code class="descname">enforce</code><span class="sig-paren">(</span><em>enforce_bounds='reset'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.enforce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.enforce" title="Permalink to this definition">¶</a></dt>
<dd><p>entry point for bounds enforcement.  This gets called for the
draw method(s), so users shouldn’t need to call this</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>enforce_bounds</strong> (<em>str</em>) – can be ‘reset’ to reset offending values or ‘drop’ to drop
offending realizations</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.enfore_scale">
<code class="descname">enfore_scale</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.enfore_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.enfore_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>enforce parameter bounds on the ensemble by finding the
scaling factor needed to bring the most violated parameter back in bounds</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this method not fully implemented.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">NotImplementedError if called.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.enforce_drop">
<code class="descname">enforce_drop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.enforce_drop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.enforce_drop" title="Permalink to this definition">¶</a></dt>
<dd><p>enforce parameter bounds on the ensemble by dropping
violating realizations</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.enforce_reset">
<code class="descname">enforce_reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.enforce_reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.enforce_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>enforce parameter bounds on the ensemble by resetting
violating vals to bound</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.read_parfiles_prefix">
<code class="descname">read_parfiles_prefix</code><span class="sig-paren">(</span><em>prefix</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.read_parfiles_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.read_parfiles_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>thin wrapper around read_parfiles using the pnulpar prefix concept.  Used to
fill ParameterEnsemble from PEST-type par files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prefix</strong> (<em>str</em>) – the par file prefix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.read_parfiles">
<code class="descname">read_parfiles</code><span class="sig-paren">(</span><em>parfile_names</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.read_parfiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.read_parfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>read the ParameterEnsemble realizations from par files.  Used to fill
the ParameterEnsemble with realizations from PEST-type par files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parfile_names</strong> (<em>list</em>) – list of par files to load</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">log transforms after loading according and possibly resets
self.__istransformed</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="pyemu.en.ParameterEnsemble.from_parfiles">
<em class="property">classmethod </em><code class="descname">from_parfiles</code><span class="sig-paren">(</span><em>pst</em>, <em>parfile_names</em>, <em>real_names=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.from_parfiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_parfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>create a parameter ensemble from parfiles.  Accepts parfiles with less than the
parameters in the control (get NaNs in the ensemble) or extra parameters in the
parfiles (get dropped)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> – pyemu.Pst</li>
<li><strong>parfile_names</strong> – list of str
par file names</li>
<li><strong>real_names</strong> – str
optional list of realization names. If None, a single integer counter is used</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pyemu.ParameterEnsemble</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.to_csv">
<code class="descname">to_csv</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.to_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>overload of pandas.DataFrame.to_csv() to account
for parameter transformation so that the saved
ParameterEnsemble csv is not in Log10 space</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>*args</strong> (<em>list</em>) – positional arguments to pass to pandas.DataFrame.to_csv()</li>
<li><strong>**kwrags</strong> (<em>dict</em>) – keyword arguments to pass to pandas.DataFrame.to_csv()</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this function back-transforms inplace with respect to
log10 before writing</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.to_binary">
<code class="descname">to_binary</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.to_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.to_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>write the parameter ensemble to a jco-style binary file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) – the filename to write</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this function back-transforms inplace with respect to
log10 before writing</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.to_parfiles">
<code class="descname">to_parfiles</code><span class="sig-paren">(</span><em>prefix</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.to_parfiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.to_parfiles" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>write the parameter ensemble to PEST-style parameter files</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prefix</strong> (<em>str</em>) – file prefix for par files</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this function back-transforms inplace with respect to
log10 before writing</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.en.ParameterEnsemble.add_base">
<code class="descname">add_base</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/en.html#ParameterEnsemble.add_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.en.ParameterEnsemble.add_base" title="Permalink to this definition">¶</a></dt>
<dd><p>add “base” control file values as a realization</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu.ev">
<span id="pyemu-ev-module"></span><h2>pyemu.ev module<a class="headerlink" href="#module-pyemu.ev" title="Permalink to this headline">¶</a></h2>
<p>module for error variance analysis, using FOSM
assumptions.</p>
<dl class="class">
<dt id="pyemu.ev.ErrVar">
<em class="property">class </em><code class="descclassname">pyemu.ev.</code><code class="descname">ErrVar</code><span class="sig-paren">(</span><em>jco</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.la.LinearAnalysis" title="pyemu.la.LinearAnalysis"><code class="xref py py-class docutils literal"><span class="pre">pyemu.la.LinearAnalysis</span></code></a></p>
<p>Derived class for error variance analysis.  Supports 2-term and
3-term error variance analysis.  Inherits from pyemu.LinearAnalysis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>**kwargs</strong> (<em>dict</em>) – keyword args to pass to the LinearAnalysis base constructor.</li>
<li><strong>omitted_parameters</strong> (<em>list</em>) – list of parameters to treat as “omitted”.  Passing this argument
activates 3-term error variance analysis.</li>
<li><strong>omitted_parcov</strong> (<em>varies</em>) – argument that can be cast to a parcov for the omitted parameters.
If None, omitted_parcov will be formed by extracting from the
LinearAnalsis.parcov attribute.</li>
<li><strong>omitted_predictions</strong> (<em>varies</em>) – argument that can be cast to a “predictions” attribute for
prediction sensitivity vectors WRT omitted parameters.  If None,
these vectors will be extracted from the LinearAnalysis.predictions
attribute</li>
<li><strong>kl</strong> (<em>bool</em>) – flag to perform KL scaling on the jacobian before error variance
calculations</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are some additional keyword args that can be passed to active
the 3-term error variance calculation</p>
</div>
<dl class="attribute">
<dt id="pyemu.ev.ErrVar.omitted_predictions">
<code class="descname">omitted_predictions</code><a class="headerlink" href="#pyemu.ev.ErrVar.omitted_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>get the omitted prediction sensitivity vectors (stored as
a pyemu.Matrix)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>omitted_predictions</strong> – a matrix of prediction sensitivity vectors (column wise) to
omitted parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>returns a reference</p>
<p class="last">if ErrorVariance.__omitted_predictions is not set, then dynamically load the
attribute before returning</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.ev.ErrVar.omitted_jco">
<code class="descname">omitted_jco</code><a class="headerlink" href="#pyemu.ev.ErrVar.omitted_jco" title="Permalink to this definition">¶</a></dt>
<dd><p>get the omitted jco</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>omitted_jco</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Jco</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>returns a reference</p>
<p class="last">if ErrorVariance.__omitted_jco is None,
then dynamically load the attribute before returning</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.ev.ErrVar.omitted_parcov">
<code class="descname">omitted_parcov</code><a class="headerlink" href="#pyemu.ev.ErrVar.omitted_parcov" title="Permalink to this definition">¶</a></dt>
<dd><p>get the omitted prior parameter covariance matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>omitted_parcov</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Cov</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>returns a reference</p>
<p class="last">If ErrorVariance.__omitted_parcov is None,
attribute is dynamically loaded</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.get_errvar_dataframe">
<code class="descname">get_errvar_dataframe</code><span class="sig-paren">(</span><em>singular_values=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.get_errvar_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.get_errvar_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>get a pandas dataframe of error variance results indexed</dt>
<dd>on singular value and (prediction name,&lt;errvar term&gt;)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>singular_values</strong> (<em>list</em>) – singular values to test.  defaults to
range(0,min(nnz_obs,nadj_par) + 1)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>pandas.DataFrame</strong> – multi-indexed pandas dataframe</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.get_identifiability_dataframe">
<code class="descname">get_identifiability_dataframe</code><span class="sig-paren">(</span><em>singular_value=None</em>, <em>precondition=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.get_identifiability_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.get_identifiability_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>get the parameter identifiability as a pandas dataframe</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>singular_value</strong> (<em>int</em>) – the singular spectrum truncation point. Defaults to minimum of
non-zero-weighted observations and adjustable parameters</li>
<li><strong>precondition</strong> (<em>bool</em>) – flag to use the preconditioned hessian (xtqt + sigma_theta^-1).
Default is False</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pandas.DataFrame</strong> – A pandas dataframe of the V_1**2 Matrix with the
identifiability in the column labeled “ident”</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.variance_at">
<code class="descname">variance_at</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.variance_at"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.variance_at" title="Permalink to this definition">¶</a></dt>
<dd><p>get the error variance of all three terms at a singluar value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>singular_value</strong> (<em>int</em>) – singular value to test</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>dict</strong> – dictionary of (err var term,prediction_name), standard_deviation pairs</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.R">
<code class="descname">R</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.R"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.R" title="Permalink to this definition">¶</a></dt>
<dd><p>get resolution Matrix (V_1 * V_1^T) at a singular value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>singular_value</strong> (<em>int</em>) – singular value to calc R at</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>R</strong> – resolution matrix at singular_value</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.I_minus_R">
<code class="descname">I_minus_R</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.I_minus_R"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.I_minus_R" title="Permalink to this definition">¶</a></dt>
<dd><p>get I - R at singular value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>singular_value</strong> (<em>int</em>) – singular value to calc R at</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>I - R</strong> – identity matrix minus resolution matrix at singular_value</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.G">
<code class="descname">G</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.G"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.G" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>get the parameter solution Matrix at a singular value</dt>
<dd>V_1 * S_1^(_1) * U_1^T</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>singular_value</strong> (<em>int</em>) – singular value to calc R at</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>G</strong> – parameter solution matrix at singular value</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.first_forecast">
<code class="descname">first_forecast</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.first_forecast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.first_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>wrapper around ErrVar.first_forecast</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.first_prediction">
<code class="descname">first_prediction</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.first_prediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.first_prediction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>get the null space term (first term) contribution to prediction error variance</dt>
<dd>at a singular value.  used to construct error variance dataframe</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>singular_value</strong> (<em>int</em>) – singular value to calc first term at</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>dict</strong> – dictionary of (“first”,prediction_names),error variance pairs at singular_value</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.first_parameter">
<code class="descname">first_parameter</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.first_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.first_parameter" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>get the null space term (first term) contribution to parameter error variance</dt>
<dd>at a singular value</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>singular_value</strong> (<em>int</em>) – singular value to calc first term at</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>first_term</strong> – first term contribution to parameter error variance</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Cov</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.second_forecast">
<code class="descname">second_forecast</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.second_forecast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.second_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>wrapper around ErrVar.second_prediction</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.second_prediction">
<code class="descname">second_prediction</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.second_prediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.second_prediction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>get the solution space contribution to predictive error variance</dt>
<dd>at a singular value (y^t * G * obscov * G^T * y).  Used to construct
error variance dataframe</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>singular_value</strong> (<em>int</em>) – singular value to calc second term at</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>dict</strong> – dictionary of (“second”,prediction_names), error variance</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.second_parameter">
<code class="descname">second_parameter</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.second_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.second_parameter" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>get the solution space contribution to parameter error variance</dt>
<dd>at a singular value (G * obscov * G^T)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>singular_value</strong> (<em>int</em>) – singular value to calc second term at</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>second_parameter</strong> – second term contribution to parameter error variance</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Cov</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.third_forecast">
<code class="descname">third_forecast</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.third_forecast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.third_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>wrapper around ErrVar.third_prediction</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.third_prediction">
<code class="descname">third_prediction</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.third_prediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.third_prediction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>get the omitted parameter contribution to prediction error variance</dt>
<dd>at a singular value. used to construct error variance dataframe</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>singular_value</strong> (<em>int</em>) – singular value to calc third term at</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>dict</strong> – dictionary of (“third”,prediction_names),error variance</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.ev.ErrVar.third_parameter">
<code class="descname">third_parameter</code><span class="sig-paren">(</span><em>singular_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/ev.html#ErrVar.third_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.ev.ErrVar.third_parameter" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>get the omitted parameter contribution to parameter error variance</dt>
<dd>at a singular value (G * omitted_jco * Sigma_(omitted_pars) * omitted_jco^T * G^T)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>singular_value</strong> (<em>int</em>) – singular value to calc third term at</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>third_parameter</strong> – 0.0 if need_omitted is False</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Cov</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu.la">
<span id="pyemu-la-module"></span><h2>pyemu.la module<a class="headerlink" href="#module-pyemu.la" title="Permalink to this headline">¶</a></h2>
<p>This module contains the LinearAnalysis object, which is the base class for
all other pyemu analysis objects (Schur, ErrVar, MonteCarlo, and EnsembleSmoother).</p>
<dl class="class">
<dt id="pyemu.la.LinearAnalysis">
<em class="property">class </em><code class="descclassname">pyemu.la.</code><code class="descname">LinearAnalysis</code><span class="sig-paren">(</span><em>jco=None</em>, <em>pst=None</em>, <em>parcov=None</em>, <em>obscov=None</em>, <em>predictions=None</em>, <em>ref_var=1.0</em>, <em>verbose=False</em>, <em>resfile=False</em>, <em>forecasts=None</em>, <em>sigma_range=4.0</em>, <em>scale_offset=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>The super class for linear analysis.  Can be used directly, but
for prior uncertainty analyses only.  The derived types
(pyemu.Schur, pyemu.ErrVar, pyemu.MonteCarlo, pyemu.EnsembleSmoother)
are for different forms of posterior uncertainty analyses. This class
tries hard to not load items until they are needed; all arguments are
optional</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>jco</strong> (<em>(</em><em>varies</em><em>)</em>) – something that can be cast or loaded into a pyemu.Jco.  Can be a
str for a filename or pyemu.Matrix/pyemu.Jco object.</li>
<li><strong>pst</strong> (<em>(</em><em>varies</em><em>)</em>) – something that can be cast into a pyemu.Pst.  Can be an str for a
filename or an existing pyemu.Pst.  If None, a pst filename is sought
with the same base name as the jco argument (if passed)</li>
<li><strong>parcov</strong> (<em>(</em><em>varies</em><em>)</em>) – prior parameter covariance matrix.  If str, a filename is assumed and
the prior parameter covariance matrix is loaded from a file using
the file extension.  If None, the prior parameter covariance matrix is
constructed from the parameter bounds in the control file represented
by the pst argument. Can also be a pyemu.Cov instance</li>
<li><strong>obscov</strong> (<em>(</em><em>varies</em><em>)</em>) – observation noise covariance matrix. If str, a filename is assumed and
the observation noise covariance matrix is loaded from a file using
the file extension.  If None, the observation noise covariance matrix is
constructed from the weights in the control file represented
by the pst argument. Can also be a pyemu.Cov instance</li>
<li><strong>predictions</strong> (<em>(</em><em>varies</em><em>)</em>) – prediction (aka forecast) sensitivity vectors.  If str, a filename
is assumed and predictions are loaded from a file using the file extension.
Can also be a pyemu.Matrix instance, a numpy.ndarray or a collection
of pyemu.Matrix or numpy.ndarray.</li>
<li><strong>ref_var</strong> (<em>(</em><em>float</em><em>)</em>) – reference variance</li>
<li><strong>verbose</strong> (<em>(</em><em>either bool</em><em> or </em><em>string</em><em>)</em>) – <dl class="docutils">
<dt>controls log file / screen output.  If str, a filename is assumed and</dt>
<dd>and log file is written to verbose</dd>
</dl>
</li>
<li><strong>sigma_range</strong> (<em>float</em>) – defines range of upper bound - lower bound in terms of standard
deviation (sigma). For example, if sigma_range = 4, the bounds
represent 4 * sigma.  Default is 4.0, representing approximately
95% confidence of implied normal distribution.  This arg is only
used if constructing parcov from parameter bounds.</li>
<li><strong>scale_offset</strong> (<em>True</em>) – flag to apply parameter scale and offset to parameter bounds
when calculating prior parameter covariance matrix from
bounds.  This arg is onlyused if constructing parcov
from parameter bounds.Default is True.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the class makes heavy use of property decorator to encapsulate
private attributes</p>
</div>
<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.forecast_names">
<code class="descname">forecast_names</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.forecast_names" title="Permalink to this definition">¶</a></dt>
<dd><p>get the forecast (aka prediction) names</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>forecast_names</strong> – list of forecast names</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.parcov">
<code class="descname">parcov</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.parcov" title="Permalink to this definition">¶</a></dt>
<dd><p>get the prior parameter covariance matrix attribute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>parcov</strong> – a reference to the parcov attribute</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Cov</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>returns a reference</p>
<p class="last">if LinearAnalysis.__parcov is not set, the dynamically load the
parcov attribute before returning</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.obscov">
<code class="descname">obscov</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.obscov" title="Permalink to this definition">¶</a></dt>
<dd><p>get the observation noise covariance matrix attribute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>obscov</strong> – a reference to the obscov attribute</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Cov</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>returns a reference</p>
<p class="last">if LinearAnalysis.__obscov is not set, the dynamically load the
obscov attribute before returning</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.nnz_obs_names">
<code class="descname">nnz_obs_names</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.nnz_obs_names" title="Permalink to this definition">¶</a></dt>
<dd><p>wrapper around pyemu.Pst.nnz_obs_names for listing non-zero
observation names</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>nnz_obs_names</strong> – pyemu.Pst.nnz_obs_names</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.la.LinearAnalysis.adj_par_names">
<code class="descname">adj_par_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis.adj_par_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis.adj_par_names" title="Permalink to this definition">¶</a></dt>
<dd><p>wrapper around pyemu.Pst.adj_par_names for list adjustable parameter
names</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>adj_par_names</strong> – pyemu.Pst.adj_par_names</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.jco">
<code class="descname">jco</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.jco" title="Permalink to this definition">¶</a></dt>
<dd><p>get the jacobian matrix attribute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>jco</strong> – the jacobian matrix attribute</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Jco</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>returns a reference</p>
<p class="last">if LinearAnalysis.__jco is not set, the dynamically load the
jco attribute before returning</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.predictions">
<code class="descname">predictions</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>get the predictions (aka forecasts) attribute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>predictions</strong> – a matrix of prediction sensitivity vectors (column wise)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>returns a reference</p>
<dl class="last docutils">
<dt>if LinearAnalysis.__predictions is not set, the dynamically load the</dt>
<dd>predictions attribute before returning</dd>
</dl>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.predictions_iter">
<code class="descname">predictions_iter</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.predictions_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>property decorated prediction iterator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>iterator</strong> – iterator on prediction sensitivity vectors (matrix)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">iterator</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.forecasts_iter">
<code class="descname">forecasts_iter</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.forecasts_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>synonym for LinearAnalysis.predictions_iter()</p>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.forecasts">
<code class="descname">forecasts</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.forecasts" title="Permalink to this definition">¶</a></dt>
<dd><p>synonym for LinearAnalysis.predictions</p>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.pst">
<code class="descname">pst</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.pst" title="Permalink to this definition">¶</a></dt>
<dd><p>get the pyemu.Pst attribute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>pst</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Pst</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>returns a references</p>
<p class="last">If LinearAnalysis.__pst is None, then the pst attribute is
dynamically loaded before returning</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.fehalf">
<code class="descname">fehalf</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.fehalf" title="Permalink to this definition">¶</a></dt>
<dd><p>get the KL parcov scaling matrix attribute.  Create the attribute if
it has not yet been created</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>fehalf</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.qhalf">
<code class="descname">qhalf</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.qhalf" title="Permalink to this definition">¶</a></dt>
<dd><p>get the square root of the cofactor matrix attribute. Create the attribute if
it has not yet been created</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>qhalf</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.qhalfx">
<code class="descname">qhalfx</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.qhalfx" title="Permalink to this definition">¶</a></dt>
<dd><p>get the half normal matrix attribute.  Create the attribute if
it has not yet been created</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>qhalfx</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.xtqx">
<code class="descname">xtqx</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.xtqx" title="Permalink to this definition">¶</a></dt>
<dd><p>get the normal matrix attribute. Create the attribute if
it has not yet been created</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>xtqx</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.mle_covariance">
<code class="descname">mle_covariance</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.mle_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>get the maximum likelihood parameter covariance matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>pyemu.Matrix</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.prior_parameter">
<code class="descname">prior_parameter</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.prior_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>the prior parameter covariance matrix.  Just a wrapper around
LinearAnalysis.parcov</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>prior_parameter</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Cov</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.prior_forecast">
<code class="descname">prior_forecast</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.prior_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>thin wrapper for prior_prediction</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>prior_forecast</strong> – a dictionary of forecast name, prior variance pairs</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.mle_parameter_estimate">
<code class="descname">mle_parameter_estimate</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.mle_parameter_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>get the maximum likelihood parameter estimate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>post_expt</strong> – the maximum likelihood parameter estimates</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.Series</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.la.LinearAnalysis.prior_prediction">
<code class="descname">prior_prediction</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.prior_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dict of prior prediction variances</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>prior_prediction</strong> – dictionary of prediction name, prior variance pairs</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.la.LinearAnalysis.apply_karhunen_loeve_scaling">
<code class="descname">apply_karhunen_loeve_scaling</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis.apply_karhunen_loeve_scaling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis.apply_karhunen_loeve_scaling" title="Permalink to this definition">¶</a></dt>
<dd><p>apply karhuene-loeve scaling to the jacobian matrix.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This scaling is not necessary for analyses using Schur’s
complement, but can be very important for error variance
analyses.  This operation effectively transfers prior knowledge
specified in the parcov to the jacobian and reset parcov to the
identity matrix.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.la.LinearAnalysis.clean">
<code class="descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>drop regularization and prior information observation from the jco</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.la.LinearAnalysis.reset_pst">
<code class="descname">reset_pst</code><span class="sig-paren">(</span><em>arg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis.reset_pst"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis.reset_pst" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the LinearAnalysis.pst attribute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arg</strong> (<em>(</em><em>str</em><em> or </em><em>matrix</em><em>)</em>) – the value to assign to the pst attribute</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.la.LinearAnalysis.reset_parcov">
<code class="descname">reset_parcov</code><span class="sig-paren">(</span><em>arg=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis.reset_parcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis.reset_parcov" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the parcov attribute to None</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arg</strong> (<em>str</em><em> or </em><em>pyemu.Matrix</em>) – the value to assign to the parcov attribute.  If None,
the private __parcov attribute is cleared but not reset</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.la.LinearAnalysis.reset_obscov">
<code class="descname">reset_obscov</code><span class="sig-paren">(</span><em>arg=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis.reset_obscov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis.reset_obscov" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the obscov attribute to None</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arg</strong> (<em>str</em><em> or </em><em>pyemu.Matrix</em>) – the value to assign to the obscov attribute.  If None,
the private __obscov attribute is cleared but not reset</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.la.LinearAnalysis.drop_prior_information">
<code class="descname">drop_prior_information</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis.drop_prior_information"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis.drop_prior_information" title="Permalink to this definition">¶</a></dt>
<dd><p>drop the prior information from the jco and pst attributes</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.la.LinearAnalysis.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>par_names=None</em>, <em>obs_names=None</em>, <em>astype=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis.get" title="Permalink to this definition">¶</a></dt>
<dd><p>method to get a new LinearAnalysis class using a
subset of parameters and/or observations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>par_names</strong> (<em>list</em>) – par names for new object</li>
<li><strong>obs_names</strong> (<em>list</em>) – obs names for new object</li>
<li><strong>astype</strong> (<em>pyemu.Schur</em><em> or </em><em>pyemu.ErrVar</em>) – type to cast the new object.  If None, return type is
same as self</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>new</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.la.LinearAnalysis" title="pyemu.la.LinearAnalysis">LinearAnalysis</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.la.LinearAnalysis.adjust_obscov_resfile">
<code class="descname">adjust_obscov_resfile</code><span class="sig-paren">(</span><em>resfile=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis.adjust_obscov_resfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis.adjust_obscov_resfile" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the elements of obscov by scaling the implied weights
based on the phi components in res_file so that the total phi
is equal to the number of non-zero weights.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>resfile</strong> (<em>str</em>) – residual file to use.  If None, residual file with case name is
sought. default is None</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">calls pyemu.Pst.adjust_weights_resfile()</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.la.LinearAnalysis.get_par_css_dataframe">
<code class="descname">get_par_css_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis.get_par_css_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis.get_par_css_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dataframe of composite scaled sensitivities.  Includes both
PEST-style and Hill-style.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>css</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.la.LinearAnalysis.get_cso_dataframe">
<code class="descname">get_cso_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/la.html#LinearAnalysis.get_cso_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.la.LinearAnalysis.get_cso_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dataframe of composite observation sensitivity, as returned by PEST in the
seo file.</p>
<p>Note that this formulation deviates slightly from the PEST documentation in that the
values are divided by (npar-1) rather than by (npar).</p>
<p>The equation is cso_j = ((Q^1/2*J*J^T*Q^1/2)^1/2)_jj/(NPAR-1)
Returns:
cso : pandas.DataFrame</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu.logger">
<span id="pyemu-logger-module"></span><h2>pyemu.logger module<a class="headerlink" href="#module-pyemu.logger" title="Permalink to this headline">¶</a></h2>
<p>module for logging pyemu progress</p>
<dl class="class">
<dt id="pyemu.logger.Logger">
<em class="property">class </em><code class="descclassname">pyemu.logger.</code><code class="descname">Logger</code><span class="sig-paren">(</span><em>filename</em>, <em>echo=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/logger.html#Logger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.logger.Logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="docutils">
<dt>a basic class for logging events during the linear analysis calculations</dt>
<dd>if filename is passed, then a file handle is opened.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) – Filename to write logged events to. If False, no file will be created,
and logged events will be displayed on standard out.</li>
<li><strong>echo</strong> (<em>bool</em>) – Flag to cause logged events to be echoed to the screen.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pyemu.logger.Logger.items">
<code class="descname">items</code><a class="headerlink" href="#pyemu.logger.Logger.items" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – Dictionary holding events to be logged.  If a log entry is
not in <cite>items</cite>, then it is treated as a new entry with the string
being the key and the datetime as the value.  If a log entry is
in <cite>items</cite>, then the end time and delta time are written and
the item is popped from the keys.</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.logger.Logger.statement">
<code class="descname">statement</code><span class="sig-paren">(</span><em>phrase</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/logger.html#Logger.statement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.logger.Logger.statement" title="Permalink to this definition">¶</a></dt>
<dd><p>log a one time statement</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phrase</strong> (<em>str</em>) – statement to log</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.logger.Logger.log">
<code class="descname">log</code><span class="sig-paren">(</span><em>phrase</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/logger.html#Logger.log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.logger.Logger.log" title="Permalink to this definition">¶</a></dt>
<dd><p>log something that happened.  The first time phrase is passed the
start time is saved.  The second time the phrase is logged, the
elapsed time is written</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phrase</strong> (<em>str</em>) – the thing that happened</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.logger.Logger.warn">
<code class="descname">warn</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/logger.html#Logger.warn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.logger.Logger.warn" title="Permalink to this definition">¶</a></dt>
<dd><p>write a warning to the log file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>message</strong> (<em>str</em>) – the warning text</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.logger.Logger.lraise">
<code class="descname">lraise</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/logger.html#Logger.lraise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.logger.Logger.lraise" title="Permalink to this definition">¶</a></dt>
<dd><p>log an exception, close the log file, then raise the exception</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>message</strong> (<em>str</em>) – the exception message</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body">exception with message</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu.mc">
<span id="pyemu-mc-module"></span><h2>pyemu.mc module<a class="headerlink" href="#module-pyemu.mc" title="Permalink to this headline">¶</a></h2>
<p>pyEMU Monte Carlo module.  Supports easy Monte Carlo
and GLUE analyses.  The MonteCarlo class inherits from
pyemu.LinearAnalysis</p>
<dl class="class">
<dt id="pyemu.mc.MonteCarlo">
<em class="property">class </em><code class="descclassname">pyemu.mc.</code><code class="descname">MonteCarlo</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/mc.html#MonteCarlo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.mc.MonteCarlo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.la.LinearAnalysis" title="pyemu.la.LinearAnalysis"><code class="xref py py-class docutils literal"><span class="pre">pyemu.la.LinearAnalysis</span></code></a></p>
<p>LinearAnalysis derived type for monte carlo analysis</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> (<em>dict</em>) – dictionary of keyword arguments.  See pyemu.LinearAnalysis for
complete definitions</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pyemu.mc.MonteCarlo.parensemble">
<code class="descname">parensemble</code><a class="headerlink" href="#pyemu.mc.MonteCarlo.parensemble" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pyemu.ParameterEnsemble</em> – pyemu object derived from a pandas dataframe, the ensemble
of parameters from the PEST control file with associated
starting value and bounds.  Object also exposes methods
relevant to the dataframe and parameters– see documentation.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.mc.MonteCarlo.obsensemble">
<code class="descname">obsensemble</code><a class="headerlink" href="#pyemu.mc.MonteCarlo.obsensemble" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pyemu.ObservationEnsemble</em> – pyemu object derived from a pandas dataframe, the ensemble
of observations from the PEST control file with associated
starting weights.  Object also exposes methods
relevant to the dataframe and observations– see documentation.</p>
</dd></dl>

<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">pyEMU MonteCarlo object</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyemu.mc.MonteCarlo" title="pyemu.mc.MonteCarlo">MonteCarlo</a></td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;mc</span> <span class="pre">=</span> <span class="pre">pyemu.MonteCarlo(pst=&quot;pest.pst&quot;)</span></code></p>
</div>
<dl class="attribute">
<dt id="pyemu.mc.MonteCarlo.num_reals">
<code class="descname">num_reals</code><a class="headerlink" href="#pyemu.mc.MonteCarlo.num_reals" title="Permalink to this definition">¶</a></dt>
<dd><p>get the number of realizations in the parameter ensemble</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>num_real</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.mc.MonteCarlo.get_nsing">
<code class="descname">get_nsing</code><span class="sig-paren">(</span><em>epsilon=0.0001</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/mc.html#MonteCarlo.get_nsing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.mc.MonteCarlo.get_nsing" title="Permalink to this definition">¶</a></dt>
<dd><p>get the number of solution space dimensions given
a ratio between the largest and smallest singular values</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>epsilon</strong> (<em>float</em>) – singular value ratio</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>nsing</strong> – number of singular components above the epsilon ratio threshold</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If nsing == nadj_par, then None is returned</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.mc.MonteCarlo.get_null_proj">
<code class="descname">get_null_proj</code><span class="sig-paren">(</span><em>nsing=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/mc.html#MonteCarlo.get_null_proj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.mc.MonteCarlo.get_null_proj" title="Permalink to this definition">¶</a></dt>
<dd><p>get a null-space projection matrix of XTQX</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nsing</strong> (<em>int</em>) – optional number of singular components to use
If Nonte, then nsing is determined from
call to MonteCarlo.get_nsing()</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>v2_proj</strong> – the null-space projection matrix (V2V2^T)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.mc.MonteCarlo.draw">
<code class="descname">draw</code><span class="sig-paren">(</span><em>num_reals=1</em>, <em>par_file=None</em>, <em>obs=False</em>, <em>enforce_bounds=None</em>, <em>cov=None</em>, <em>how='gaussian'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/mc.html#MonteCarlo.draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.mc.MonteCarlo.draw" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>draw stochastic realizations of parameters and</dt>
<dd>optionally observations, filling MonteCarlo.parensemble and
optionally MonteCarlo.obsensemble.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_reals</strong> (<em>int</em>) – number of realization to generate</li>
<li><strong>par_file</strong> (<em>str</em>) – parameter file to use as mean values. If None,
use MonteCarlo.pst.parameter_data.parval1.
Default is None</li>
<li><strong>obs</strong> (<em>bool</em>) – add a realization of measurement noise to observation values,
forming MonteCarlo.obsensemble.Default is False</li>
<li><strong>enforce_bounds</strong> (<em>str</em>) – enforce parameter bounds based on control file information.
options are ‘reset’, ‘drop’ or None.  Default is None</li>
<li><strong>how</strong> (<em>str</em>) – type of distribution to draw from. Must be in [“gaussian”,”uniform”]
default is “gaussian”.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;mc</span> <span class="pre">=</span> <span class="pre">pyemu.MonteCarlo(pst=&quot;pest.pst&quot;)</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;mc.draw(1000)</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.mc.MonteCarlo.project_parensemble">
<code class="descname">project_parensemble</code><span class="sig-paren">(</span><em>par_file=None</em>, <em>nsing=None</em>, <em>inplace=True</em>, <em>enforce_bounds='reset'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/mc.html#MonteCarlo.project_parensemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.mc.MonteCarlo.project_parensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>perform the null-space projection operations for null-space monte carlo</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>par_file</strong> (<em>str</em>) – an optional file of parameter values to use</li>
<li><strong>nsing</strong> (<em>int</em>) – number of singular values to in forming null subspace matrix</li>
<li><strong>inplace</strong> (<em>bool</em>) – overwrite the existing parameter ensemble with the
projected values</li>
<li><strong>enforce_bounds</strong> (<em>str</em>) – how to enforce parameter bounds.  can be None, ‘reset’, or ‘drop’.
Default is None</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>par_en</strong> – if inplace is False, otherwise None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyemu.ParameterEnsemble</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">to use this method, the MonteCarlo instance must have been constructed
with the <code class="docutils literal"><span class="pre">jco</span></code> argument.</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;mc</span> <span class="pre">=</span> <span class="pre">pyemu.MonteCarlo(jco=&quot;pest.jcb&quot;)</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;mc.draw(1000)</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;mc.project_parensemble(par_file=&quot;final.par&quot;,nsing=100)</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.mc.MonteCarlo.write_psts">
<code class="descname">write_psts</code><span class="sig-paren">(</span><em>prefix</em>, <em>existing_jco=None</em>, <em>noptmax=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/mc.html#MonteCarlo.write_psts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.mc.MonteCarlo.write_psts" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>write parameter and optionally observation realizations</dt>
<dd>to a series of pest control files</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>prefix</strong> (<em>str</em>) – pest control file prefix</li>
<li><strong>existing_jco</strong> (<em>str</em>) – filename of an existing jacobian matrix to add to the
pest++ options in the control file.  This is useful for
NSMC since this jco can be used to get the first set of
parameter upgrades for free!  Needs to be the path the jco
file as seen from the location where pest++ will be run</li>
<li><strong>noptmax</strong> (<em>int</em>) – value of NOPTMAX to set in new pest control files</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;mc</span> <span class="pre">=</span> <span class="pre">pyemu.MonteCarlo(jco=&quot;pest.jcb&quot;)</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;mc.draw(1000,</span> <span class="pre">obs=True)</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;mc.write_psts(&quot;mc_&quot;,</span> <span class="pre">existing_jco=&quot;pest.jcb&quot;,</span> <span class="pre">noptmax=1)</span></code></p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu.sc">
<span id="pyemu-sc-module"></span><h2>pyemu.sc module<a class="headerlink" href="#module-pyemu.sc" title="Permalink to this headline">¶</a></h2>
<p>module for FOSM-based uncertainty analysis using a
linearized form of Bayes equation known as the Schur compliment</p>
<dl class="class">
<dt id="pyemu.sc.Schur">
<em class="property">class </em><code class="descclassname">pyemu.sc.</code><code class="descname">Schur</code><span class="sig-paren">(</span><em>jco</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.la.LinearAnalysis" title="pyemu.la.LinearAnalysis"><code class="xref py py-class docutils literal"><span class="pre">pyemu.la.LinearAnalysis</span></code></a></p>
<p>derived type for prior and posterior uncertainty and data-worth
analysis using Schur compliment</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> (<em>dict</em>) – keyword arguments to pass to the LinearAnalysis constructor.  See
LinearAnalysis definition for argument types</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Same call signature as the base LinearAnalysis class</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;sc</span> <span class="pre">=</span> <span class="pre">pyemu.Schur(jco=&quot;pest.jcb&quot;)</span></code></p>
</div>
<dl class="attribute">
<dt id="pyemu.sc.Schur.pandas">
<code class="descname">pandas</code><a class="headerlink" href="#pyemu.sc.Schur.pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>get a pandas dataframe of prior and posterior for all predictions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>pandas.DataFrame</dt>
<dd>a dataframe with prior and posterior uncertainty estimates
for all forecasts (predictions)</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.sc.Schur.posterior_parameter">
<code class="descname">posterior_parameter</code><a class="headerlink" href="#pyemu.sc.Schur.posterior_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>get the posterior parameter covariance matrix.  If Schur.__posterior_parameter
is None, the posterior parameter covariance matrix is calculated via
Schur compliment before returning</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>posterior_parameter</strong> – the posterior parameter covariance matrix</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Cov</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">returns a reference</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;sc</span> <span class="pre">=</span> <span class="pre">pyemu.Schur(jco=&quot;pest.jcb&quot;)</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;post_cov</span> <span class="pre">=</span> <span class="pre">sc.posterior_parameter</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;post_cov.to_ascii(&quot;post.cov&quot;)</span></code></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.sc.Schur.map_parameter_estimate">
<code class="descname">map_parameter_estimate</code><a class="headerlink" href="#pyemu.sc.Schur.map_parameter_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>get the posterior expectation for parameters using Bayes linear
estimation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>post_expt</strong> – a dataframe with prior and posterior parameter expectations</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.sc.Schur.map_forecast_estimate">
<code class="descname">map_forecast_estimate</code><a class="headerlink" href="#pyemu.sc.Schur.map_forecast_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>get the prior and posterior forecast (prediction) expectations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>pandas.DataFrame</strong> – dataframe with prior and posterior forecast expected values</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.sc.Schur.posterior_forecast">
<code class="descname">posterior_forecast</code><a class="headerlink" href="#pyemu.sc.Schur.posterior_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>thin wrapper around posterior_prediction</p>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.sc.Schur.posterior_prediction">
<code class="descname">posterior_prediction</code><a class="headerlink" href="#pyemu.sc.Schur.posterior_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>get posterior forecast (prediction) variances</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>dict</strong> – a dictionary of forecast names, posterior variance pairs</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method is not as easy to use as Schur.get_forecast_summary(), please
use it instead</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.get_parameter_summary">
<code class="descname">get_parameter_summary</code><span class="sig-paren">(</span><em>include_map=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.get_parameter_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.get_parameter_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>get a summary of the parameter uncertainty</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>include_map</strong> (<em>bool</em>) – if True, add the prior and posterior expectations
and report standard deviation instead of variance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>pandas.DataFrame</strong> – dataframe of prior,posterior variances and percent
uncertainty reduction of each parameter</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this is the primary method for accessing parameter uncertainty
estimates - use this!</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;sc</span> <span class="pre">=</span> <span class="pre">pyemu.Schur(jco=&quot;pest.jcb&quot;)</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;sc</span> <span class="pre">=</span> <span class="pre">pyemu.Schur(jco=&quot;pest.jcb&quot;,forecasts=[&quot;fore1&quot;,&quot;fore2&quot;])</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;par_sum</span> <span class="pre">=</span> <span class="pre">sc.get_parameter_summary()</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;par_sum.plot(kind=&quot;bar&quot;)</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;plt.show()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.get_forecast_summary">
<code class="descname">get_forecast_summary</code><span class="sig-paren">(</span><em>include_map=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.get_forecast_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.get_forecast_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>get a summary of the forecast uncertainty</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>include_map</strong> (<em>bool</em>) – if True, add the prior and posterior expectations
and report standard deviation instead of variance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>pandas.DataFrame</strong> – dataframe of prior,posterior variances and percent
uncertainty reduction of each parameter</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this is the primary method for accessing forecast uncertainty
estimates - use this!</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p>This usage assumes you have set the <code class="docutils literal"><span class="pre">++forecasts()</span></code> argument in the
control file:</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;sc</span> <span class="pre">=</span> <span class="pre">pyemu.Schur(jco=&quot;pest.jcb&quot;)</span></code></p>
<p>or, you can pass the forecasts directly, assuming the forecasts are
names of zero-weight observations:</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;sc</span> <span class="pre">=</span> <span class="pre">pyemu.Schur(jco=&quot;pest.jcb&quot;,forecasts=[&quot;fore1&quot;,&quot;fore2&quot;])</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;fore_sum</span> <span class="pre">=</span> <span class="pre">sc.get_forecast_summary()</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;fore_sum.plot(kind=&quot;bar&quot;)</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;plt.show()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.get_conditional_instance">
<code class="descname">get_conditional_instance</code><span class="sig-paren">(</span><em>parameter_names</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.get_conditional_instance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.get_conditional_instance" title="Permalink to this definition">¶</a></dt>
<dd><p>get a new Schur instance that includes conditional update from
some parameters becoming known perfectly</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parameter_names</strong> (<em>list</em>) – parameters that are to be treated as notionally perfectly
known</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>la_cond</strong> – a new Schur instance conditional on perfect knowledge
of some parameters</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyemu.sc.Schur" title="pyemu.sc.Schur">Schur</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this method is used by the get_parameter_contribution() method -
don’t call this method directly</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.get_par_contribution">
<code class="descname">get_par_contribution</code><span class="sig-paren">(</span><em>parlist_dict=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.get_par_contribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.get_par_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dataframe the prior and posterior uncertainty
reduction as a result of some parameter becoming perfectly known</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parlist_dict</strong> (<em>dict</em>) – a nested dictionary-list of groups of parameters
that are to be treated as perfectly known.  key values become
row labels in returned dataframe.  If None, each adjustable parameter
is sequentially treated as known and the returned dataframe
has row labels for each adjustable parameter</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>pandas.DataFrame</strong> – a dataframe that summarizes the parameter contribution analysis.
The dataframe has index (row labels) of the keys in parlist_dict
and a column labels of forecast names.  The values in the dataframe
are the posterior variance of the forecast conditional on perfect
knowledge of the parameters in the values of parlist_dict</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;sc</span> <span class="pre">=</span> <span class="pre">pyemu.Schur(jco=&quot;pest.jcb&quot;)</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;df</span> <span class="pre">=</span> <span class="pre">sc.get_par_contribution()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.get_par_group_contribution">
<code class="descname">get_par_group_contribution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.get_par_group_contribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.get_par_group_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>get the forecast uncertainty contribution from each parameter
group.  Just some sugar for get_contribution_dataframe() - this method
automatically constructs the parlist_dict argument where the keys are the
group names and the values are the adjustable parameters in the groups</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>pandas.DataFrame</strong> – a dataframe that summarizes the parameter contribution analysis.
The dataframe has index (row labels) that are the parameter groups
and a column labels of forecast names.  The values in the dataframe
are the posterior variance of the forecast conditional on perfect
knowledge of the adjustable parameters in each parameter groups</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.get_added_obs_importance">
<code class="descname">get_added_obs_importance</code><span class="sig-paren">(</span><em>obslist_dict=None</em>, <em>base_obslist=None</em>, <em>reset_zero_weight=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.get_added_obs_importance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.get_added_obs_importance" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dataframe fo the posterior uncertainty
as a results of added some observations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obslist_dict</strong> (<em>dict</em>) – a nested dictionary-list of groups of observations
that are to be treated as gained.  key values become
row labels in returned dataframe. If None, then every zero-weighted
observation is tested sequentially. Default is None</li>
<li><strong>base_obslist</strong> (<em>list</em>) – observation names to treat as the “existing” observations.
The values of obslist_dict will be added to this list during
each test.  If None, then the values in obslist_dict will
be treated as the entire calibration dataset.  That is, there
are no existing data. Default is None.  Standard practice would
be to pass this argument as Schur.pst.nnz_obs_names.</li>
<li><strong>reset_zero_weight</strong> (<em>(</em><em>boolean</em><em> or </em><em>float</em><em>)</em>) – a flag to reset observations with zero weight in either
obslist_dict or base_obslist. The value of reset_zero_weights
can be cast to a float,then that value will be assigned to
zero weight obs.  Otherwise, zero weight obs will be given a
weight of 1.0.  Default is False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pandas.DataFrame</strong> – dataframe with row labels (index) of obslist_dict.keys() and
columns of forecast_name.  The values in the dataframe are the
posterior variance of the forecasts resulting from notional inversion
using the observations in obslist_dict[key value] plus the observations
in base_obslist (if any)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">all observations listed in obslist_dict and base_obslist with zero
weights will be dropped unless reset_zero_weight is set</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;sc</span> <span class="pre">=</span> <span class="pre">pyemu.Schur(jco=&quot;pest.jcb&quot;)</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;df</span> <span class="pre">=</span> <span class="pre">sc.get_added_obs_importance(base_obslist=sc.pst.nnz_obs_names,reset_zero=True)</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.get_removed_obs_importance">
<code class="descname">get_removed_obs_importance</code><span class="sig-paren">(</span><em>obslist_dict=None</em>, <em>reset_zero_weight=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.get_removed_obs_importance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.get_removed_obs_importance" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dataframe the posterior uncertainty
as a result of losing some observations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obslist_dict</strong> (<em>dict</em>) – dictionary of groups of observations
that are to be treated as lost.  key values become
row labels in returned dataframe. If None, then test every
(nonzero weight - see reset_zero_weight) observation</li>
<li><strong>reset_zero_weight</strong> (<em>bool</em><em> or </em><em>float</em>) – a flag to reset observations with zero weight in obslist_dict.
If the value of reset_zero_weights can be cast to a float,
then that value will be assigned to zero weight obs.  Otherwise,
zero weight obs will be given a weight of 1.0</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pandas.DataFrame</strong> – a dataframe with index of obslist_dict.keys() and columns
of forecast names.  The values in the dataframe are the posterior
variances of the forecasts resulting from losing the information
contained in obslist_dict[key value]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">all observations listed in obslist_dict with zero
weights will be dropped unless reset_zero_weight is set</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;sc</span> <span class="pre">=</span> <span class="pre">pyemu.Schur(jco=&quot;pest.jcb&quot;)</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">df</span> <span class="pre">=</span> <span class="pre">sc.get_removed_obs_importance()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.obs_group_importance">
<code class="descname">obs_group_importance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.obs_group_importance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.obs_group_importance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.get_removed_obs_group_importance">
<code class="descname">get_removed_obs_group_importance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.get_removed_obs_group_importance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.get_removed_obs_group_importance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.get_added_obs_group_importance">
<code class="descname">get_added_obs_group_importance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.get_added_obs_group_importance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.get_added_obs_group_importance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.next_most_important_added_obs">
<code class="descname">next_most_important_added_obs</code><span class="sig-paren">(</span><em>forecast=None</em>, <em>niter=3</em>, <em>obslist_dict=None</em>, <em>base_obslist=None</em>, <em>reset_zero_weight=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.next_most_important_added_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.next_most_important_added_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>find the most important observation(s) by sequentially evaluating
the importance of the observations in obslist_dict. The most important observations
from each iteration is added to base_obslist and removed obslist_dict for the
next iteration.  In this way, the added observation importance values include
the conditional information from the last iteration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>forecast</strong> (<em>str</em>) – name of the forecast to use in the ranking process.  If
more than one forecast has been listed, this argument is required</li>
<li><strong>niter</strong> (<em>int</em>) – number of sequential iterations</li>
<li><strong>dict</strong> (<em>obslist_dict</em>) – nested dictionary-list of  groups of observations
that are to be treated as gained.  key values become
row labels in result dataframe. If None, then test every observation
individually</li>
<li><strong>base_obslist</strong> (<em>list</em>) – observation names to treat as the “existing” observations.
The values of obslist_dict will be added to this list during testing.
If None, then each list in the values of obslist_dict will be
treated as an individual calibration dataset.</li>
<li><strong>reset_zero_weight</strong> (<em>(</em><em>boolean</em><em> or </em><em>float</em><em>)</em>) – a flag to reset observations with zero weight in either
obslist_dict or base_obslist. If the value of reset_zero_weights
can be cast to a float,then that value will be assigned to
zero weight obs.  Otherwise, zero weight obs will be given a weight of 1.0</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pandas.DataFrame</strong> – DataFrame with columns of best obslist_dict key for each iteration.
Columns of forecast variance percent reduction for this iteration,
(percent reduction compared to initial base case)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;sc</span> <span class="pre">=</span> <span class="pre">pyemu.Schur(jco=&quot;pest.jcb&quot;)</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;df</span> <span class="pre">=</span> <span class="pre">sc.next_most_added_importance_obs(forecast=&quot;fore1&quot;,</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">base_obslist=sc.pst.nnz_obs_names,reset_zero=True</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.sc.Schur.next_most_par_contribution">
<code class="descname">next_most_par_contribution</code><span class="sig-paren">(</span><em>niter=3</em>, <em>forecast=None</em>, <em>parlist_dict=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/sc.html#Schur.next_most_par_contribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.sc.Schur.next_most_par_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>find the largest parameter(s) contribution for prior and posterior
forecast  by sequentially evaluating the contribution of parameters in
parlist_dict.  The largest contributing parameters from each iteration are
treated as known perfectly for the remaining iterations.  In this way, the
next iteration seeks the next most influential group of parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>forecast</strong> (<em>str</em>) – name of the forecast to use in the ranking process.  If
more than one forecast has been listed, this argument is required</li>
<li><strong>parlist_dict</strong> (<em>dict</em>) – a nested dictionary-list of groups of parameters
that are to be treated as perfectly known.  key values become
row labels in dataframe</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pandas.DataFrame</strong> – a dataframe with index of iteration number and columns
of parlist_dict keys.  The values are the results of the knowing
each parlist_dict entry expressed as posterior variance reduction</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu.smoother">
<span id="pyemu-smoother-module"></span><h2>pyemu.smoother module<a class="headerlink" href="#module-pyemu.smoother" title="Permalink to this headline">¶</a></h2>
<p>this is a prototype ensemble smoother based on the LM-EnRML
algorithm of Chen and Oliver 2013.  It requires the pest++ “sweep” utility
to propagate the ensemble forward.</p>
<dl class="class">
<dt id="pyemu.smoother.Phi">
<em class="property">class </em><code class="descclassname">pyemu.smoother.</code><code class="descname">Phi</code><span class="sig-paren">(</span><em>em</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#Phi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.Phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Container class for dealing with ensemble residuals and phi vectors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>em</strong> (<a class="reference internal" href="#pyemu.smoother.EnsembleMethod" title="pyemu.smoother.EnsembleMethod"><em>EnsembleMethod</em></a>) – </td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pyemu.smoother.Phi.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>cur_lam=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#Phi.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.Phi.write" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyemu.smoother.Phi.phi_vec_dict">
<code class="descname">phi_vec_dict</code><a class="headerlink" href="#pyemu.smoother.Phi.phi_vec_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyemu.smoother.Phi.get_meas_and_regul_phi">
<code class="descname">get_meas_and_regul_phi</code><span class="sig-paren">(</span><em>obsensemble</em>, <em>parensemble</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#Phi.get_meas_and_regul_phi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.Phi.get_meas_and_regul_phi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyemu.smoother.Phi.update">
<code class="descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#Phi.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.Phi.update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyemu.smoother.Phi.report">
<code class="descname">report</code><span class="sig-paren">(</span><em>cur_lam=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#Phi.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.Phi.report" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyemu.smoother.Phi.get_residual_obs_matrix">
<code class="descname">get_residual_obs_matrix</code><span class="sig-paren">(</span><em>obsensemble</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#Phi.get_residual_obs_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.Phi.get_residual_obs_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyemu.smoother.Phi.get_residual_par_matrix">
<code class="descname">get_residual_par_matrix</code><span class="sig-paren">(</span><em>parensemble</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#Phi.get_residual_par_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.Phi.get_residual_par_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyemu.smoother.EnsembleMethod">
<em class="property">class </em><code class="descclassname">pyemu.smoother.</code><code class="descname">EnsembleMethod</code><span class="sig-paren">(</span><em>pst</em>, <em>parcov=None</em>, <em>obscov=None</em>, <em>num_slaves=0</em>, <em>use_approx_prior=True</em>, <em>submit_file=None</em>, <em>verbose=False</em>, <em>port=4004</em>, <em>slave_dir='template'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#EnsembleMethod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.EnsembleMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Base class for ensemble-type methods.  Should not be instantiated directly</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em><em> or </em><em>str</em>) – a control file instance or filename</li>
<li><strong>parcov</strong> (<em>pyemu.Cov</em><em> or </em><em>str</em>) – a prior parameter covariance matrix or filename. If None,
parcov is constructed from parameter bounds (diagonal)</li>
<li><strong>obscov</strong> (<em>pyemu.Cov</em><em> or </em><em>str</em>) – a measurement noise covariance matrix or filename. If None,
obscov is constructed from observation weights.</li>
<li><strong>num_slaves</strong> (<em>int</em>) – number of slaves to use in (local machine) parallel evaluation of the parmaeter
ensemble.  If 0, serial evaluation is used.  Ignored if submit_file is not None</li>
<li><strong>submit_file</strong> (<em>str</em>) – the name of a HTCondor submit file.  If not None, HTCondor is used to
evaluate the parameter ensemble in parallel by issuing condor_submit
as a system command</li>
<li><strong>port</strong> (<em>int</em>) – the TCP port number to communicate on for parallel run management</li>
<li><strong>slave_dir</strong> (<em>str</em>) – path to a directory with a complete set of model files and PEST
interface files</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pyemu.smoother.EnsembleMethod.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#EnsembleMethod.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.EnsembleMethod.initialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyemu.smoother.EnsembleMethod.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>lambda_mults=[1.0], localizer=None, run_subset=None, use_approx=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#EnsembleMethod.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.EnsembleMethod.update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyemu.smoother.EnsembleSmoother">
<em class="property">class </em><code class="descclassname">pyemu.smoother.</code><code class="descname">EnsembleSmoother</code><span class="sig-paren">(</span><em>pst</em>, <em>parcov=None</em>, <em>obscov=None</em>, <em>num_slaves=0</em>, <em>submit_file=None</em>, <em>verbose=False</em>, <em>port=4004</em>, <em>slave_dir='template'</em>, <em>drop_bad_reals=None</em>, <em>save_mats=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#EnsembleSmoother"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.EnsembleSmoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.smoother.EnsembleMethod" title="pyemu.smoother.EnsembleMethod"><code class="xref py py-class docutils literal"><span class="pre">pyemu.smoother.EnsembleMethod</span></code></a></p>
<p>an implementation of the GLM iterative ensemble smoother</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em><em> or </em><em>str</em>) – a control file instance or filename</li>
<li><strong>parcov</strong> (<em>pyemu.Cov</em><em> or </em><em>str</em>) – a prior parameter covariance matrix or filename. If None,
parcov is constructed from parameter bounds (diagonal)</li>
<li><strong>obscov</strong> (<em>pyemu.Cov</em><em> or </em><em>str</em>) – a measurement noise covariance matrix or filename. If None,
obscov is constructed from observation weights.</li>
<li><strong>num_slaves</strong> (<em>int</em>) – number of slaves to use in (local machine) parallel evaluation of the parmaeter
ensemble.  If 0, serial evaluation is used.  Ignored if submit_file is not None</li>
<li><strong>use_approx_prior</strong> (<em>bool</em>) – a flag to use the MLE (approx) upgrade solution.  If True, a MAP
solution upgrade is used</li>
<li><strong>submit_file</strong> (<em>str</em>) – the name of a HTCondor submit file.  If not None, HTCondor is used to
evaluate the parameter ensemble in parallel by issuing condor_submit
as a system command</li>
<li><strong>port</strong> (<em>int</em>) – the TCP port number to communicate on for parallel run management</li>
<li><strong>slave_dir</strong> (<em>str</em>) – path to a directory with a complete set of model files and PEST
interface files</li>
<li><strong>drop_bad_reals</strong> (<em>float</em>) – drop realizations with phi greater than drop_bad_reals. If None, all
realizations are kept. Default is None</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;es</span> <span class="pre">=</span> <span class="pre">pyemu.EnsembleSmoother(pst=&quot;pest.pst&quot;)</span></code></p>
</div>
<dl class="method">
<dt id="pyemu.smoother.EnsembleSmoother.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>num_reals=1</em>, <em>init_lambda=None</em>, <em>enforce_bounds='reset'</em>, <em>parensemble=None</em>, <em>obsensemble=None</em>, <em>restart_obsensemble=None</em>, <em>regul_factor=0.0</em>, <em>use_approx_prior=True</em>, <em>build_empirical_prior=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#EnsembleSmoother.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.EnsembleSmoother.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the iES process.  Depending on arguments, draws or loads
initial parameter observations ensembles and runs the initial parameter
ensemble</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_reals</strong> (<em>int</em>) – the number of realizations to draw.  Ignored if parensemble/obsensemble
are not None</li>
<li><strong>init_lambda</strong> (<em>float</em>) – the initial lambda to use.  During subsequent updates, the lambda is
updated according to upgrade success</li>
<li><strong>enforce_bounds</strong> (<em>str</em>) – how to enfore parameter bound transgression.  options are
reset, drop, or None</li>
<li><strong>parensemble</strong> (<em>pyemu.ParameterEnsemble</em><em> or </em><em>str</em>) – a parameter ensemble or filename to use as the initial
parameter ensemble.  If not None, then obsenemble must not be
None</li>
<li><strong>obsensemble</strong> (<em>pyemu.ObservationEnsemble</em><em> or </em><em>str</em>) – an observation ensemble or filename to use as the initial
observation ensemble.  If not None, then parensemble must
not be None</li>
<li><strong>restart_obsensemble</strong> (<em>pyemu.ObservationEnsemble</em><em> or </em><em>str</em>) – an observation ensemble or filename to use as an
evaluated observation ensemble.  If not None, this will skip the initial
parameter ensemble evaluation - user beware!</li>
<li><strong>regul_factor</strong> (<em>float</em>) – the regularization penalty fraction of the composite objective.  The
Prurist, MAP solution would be regul_factor = 1.0, yielding equal
parts measurement and regularization to the composite objective function.
Default is 0.0, which means only seek to minimize the measurement objective
function</li>
<li><strong>use_approx_prior</strong> (<em>bool</em>) – a flag to use the inverse, square root of the prior ccovariance matrix
for scaling the upgrade calculation.  If True, this matrix is not used.
Default is True</li>
<li><strong>build_empirical_prior</strong> (<em>bool</em>) – flag to build the prior parameter covariance matrix from an existing parensemble.
If True and parensemble is None, an exception is raised</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;es</span> <span class="pre">=</span> <span class="pre">pyemu.EnsembleSmoother(pst=&quot;pest.pst&quot;)</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;es.initialize(num_reals=100)</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.smoother.EnsembleSmoother.get_localizer">
<code class="descname">get_localizer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#EnsembleSmoother.get_localizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.EnsembleSmoother.get_localizer" title="Permalink to this definition">¶</a></dt>
<dd><p>get an empty/generic localizer matrix that can be filled</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>localizer</strong> – matrix with nnz obs names for rows and adj par names for columns</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pyemu.Matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.smoother.EnsembleSmoother.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>lambda_mults=[1.0], localizer=None, run_subset=None, use_approx=True, calc_only=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/smoother.html#EnsembleSmoother.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.smoother.EnsembleSmoother.update" title="Permalink to this definition">¶</a></dt>
<dd><p>update the iES one GLM cycle</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lambda_mults</strong> (<em>list</em>) – a list of lambda multipliers to test.  Each lambda mult value will require
evaluating (a subset of) the parameter ensemble.</li>
<li><strong>localizer</strong> (<em>pyemu.Matrix</em>) – a jacobian localizing matrix</li>
<li><strong>run_subset</strong> (<em>int</em>) – the number of realizations to test for each lambda_mult value.  For example,
if run_subset = 30 and num_reals=100, the first 30 realizations will be run (in
parallel) for each lambda_mult value.  Then the best lambda_mult is selected and the
remaining 70 realizations for that lambda_mult value are run (in parallel).</li>
<li><strong>use_approx</strong> (<em>bool</em>) – a flag to use the MLE or MAP upgrade solution.  True indicates use MLE solution</li>
<li><strong>calc_only</strong> (<em>bool</em>) – a flag to calculate the upgrade matrix only (not run the ensemble). This is mostly for
debugging and testing on travis. Default is False</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;es</span> <span class="pre">=</span> <span class="pre">pyemu.EnsembleSmoother(pst=&quot;pest.pst&quot;)</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;&gt;&gt;es.initialize(num_reals=100)</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">&gt;&gt;&gt;es.update(lambda_mults=[0.1,1.0,10.0],run_subset=30)</span></code></p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyemu" title="Permalink to this headline">¶</a></h2>
<p>pyEMU: python modules for Environmental Model Uncertainty analyses.  These
modules are designed to work directly and seamlessly with PEST and PEST++ model
independent interface.  pyEMU can also be used to setup this interface.</p>
<p>Several forms of uncertainty analyses are support including FOSM-based
analyses (pyemu.Schur and pyemu.ErrVar), Monte Carlo (including
GLUE and null-space Monte Carlo) and a prototype iterative Ensemble Smoother</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pyemu package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-pyemu.en">pyemu.en module</a></li>
<li><a class="reference internal" href="#module-pyemu.ev">pyemu.ev module</a></li>
<li><a class="reference internal" href="#module-pyemu.la">pyemu.la module</a></li>
<li><a class="reference internal" href="#module-pyemu.logger">pyemu.logger module</a></li>
<li><a class="reference internal" href="#module-pyemu.mc">pyemu.mc module</a></li>
<li><a class="reference internal" href="#module-pyemu.sc">pyemu.sc module</a></li>
<li><a class="reference internal" href="#module-pyemu.smoother">pyemu.smoother module</a></li>
<li><a class="reference internal" href="#module-pyemu">Module contents</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/source/pyemu.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Jeremy White, Mike Fienen, John Doherty.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/source/pyemu.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>